<html>
<head>
	<title>frame differencing</title>
	<style>
		body{
			margin: 0;
		}
	</style>
</head>
<body>
<script id="fs" type="x-fragment/x-shader">
uniform sampler2D texture; 
uniform float time; // seconds
varying vec2 vUv;
uniform vec2 resolution;

void main() {
    gl_FragColor = texture2D(texture, vUv);
}
</script>
<script id="vs" type="x-shader/x-vertex">

    varying vec2 vUv;
    uniform float time;
    void main() {
        vUv = uv;
        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
    }
</script>
<script id="diffFs">
uniform sampler2D texture;
uniform sampler2D texture2;
uniform sampler2D texture3;
varying vec2 vUv;

void main() {
  vec4 tex0 = texture2D(texture, vUv);
  vec4 tex1 = texture2D(texture2, vUv);
  vec4 tex2 = texture2D(texture3, vUv);

  vec4 fc = (tex2 - tex1);
  float avg = dot(tex2.rgb - tex1.rgb, vec3(1.0))/3.0;
  //fc = avg <= 0.01  ? fc : 1.0-fc;
  vec4 add = (fc + tex0);
  gl_FragColor = fract(fc);//mod(add,tex2.r);
  // gl_FragColor = smoothstep(tex2,tex0,mod(add,tex2.r));
}
</script>
<script type="x-shader/x-fragment" id="fbFs">
varying vec2 vUv;
uniform sampler2D texture;
uniform sampler2D texture2;


void main(){

    vec2 tc = vUv;
    vec4 look = texture2D(texture,tc);//sample repos texture
    vec2 offs = vec2(look.y-look.x,look.w-look.z)*0.009;
    vec2 coord = offs+tc;  //relative coordinates
    
    vec4 repos = texture2D(texture, coord);
    
    gl_FragColor = repos;    
} 

</script>
<script id="flowFs">
   
    uniform vec2 resolution;
    uniform float time;
    uniform sampler2D texture;
    varying vec2 vUv;
    uniform float mouseX;
    uniform float mouseY;

    void main( void ){
      vec2 p = gl_FragCoord.xy / resolution.xy;
      
      // vec2 uv = p*0.15 + 0.25;
      vec2 uv = vUv;
      // vec2 uv = vUv*0.05 + vec2(0.62, 0.57);
      
      vec2 e = 0.5/resolution.xy;
      
      
       float am1 = 0.5*sin( time );
      // float am1 = 3.333;
       float am2 = 0.5*cos( time );
      // float am2 = 10.0;
      
      for( int i=0; i<25; i++ ){
        float h  = dot( texture2D(texture, uv*0.5             ).xyz, vec3(0.333) );
        float h1 = dot( texture2D(texture, uv+vec2(e.x,mouseX)).xyz, vec3(0.333) );
        float h2 = dot( texture2D(texture, uv+vec2(mouseY,e.y)).xyz, vec3(0.333) );
            // gradient
        vec2 g = 0.00075*vec2( (h1-h), (h2-h) )/e;
            // isoline    
        vec2 f = g.yx*vec2(-1.0,1.0);
        // vec2 f = g.yx*vec2(10.0*mouseX, 10.0*mouseY);
        
        g = mix( g, f, 0.5 );
        
        uv += 0.00075*g*cos(time);
      }
      
      vec3 col = texture2D(texture, uv).xyz;
      
       //  col *= 2.0;
        
      gl_FragColor = vec4(col, 1.0);
    }
</script>
<script src="three.min.js"></script>
<script src="BinaryLoader.js"></script>
<script src="Detector.js"></script>
<script src="OrbitControls.js"></script>
<script src="dat.gui.min.js"></script>
<script src="main.js"></script>
</body>
</html>